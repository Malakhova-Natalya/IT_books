# Ralph Kimball, Margy Ross "The Data Warehouse Toolkit. The Definitive Guide to Dimensional Modeling" (Third Edition) 

## Chapter 2 

## Kimball Dimensional Modeling Techniques Overview /<br> Обзор методов размерного моделирования Кимбалла


Содержание:
- [Fundamental Concepts](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#fundamental-concepts) *(Основные понятия)*

- [Basic Fact Table Techniques](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball,%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#basic-fact-table-techniques) *(Основные методы составления таблиц фактов)*

- [Basic Dimensional Table Techniques](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#basic-dimensional-table-techniques) *(Основные методы работы с размерными таблицами)*

- [Integration via Conformed Dimensions](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#integration-via-conformed-dimensions) *(Интеграция посредством конформных размеров)*

- [Dealing with Slowly Changing Dimension Attributes](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#dealing-with-slowly-changing-dimension-attributes) *(Работа с медленно изменяющимися атрибутами измерений)*

- [Dealing with Dimension Hierarchies](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#dealing-with-dimension-hierarchies) *(Работа с иерархиями измерений)*

- [Advanced Fact Table Techniques](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#advanced-fact-table-techniques) *(Передовые методы составления таблиц фактов)*

- [Advanced Dimension Techniques](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#advanced-dimension-techniques) *(Передовые методы измерения)*
- [Special Purpose Schemas](https://github.com/Malakhova-Natalya/IT_books/blob/main/all_books/Ralph%20Kimball%2C%20Margy%20Ross%20-%20The%20Data%20Warehouse%20Toolkit/contents/chapter_02/README.md#special-purpose-schemas) *(Схемы специального назначения)*


Поначалу, со времен первого издания (1996), группа Кимбалла определила набор техник размерного моделирования. Авторы чувствовали, что эти техники нужно представить через примеры знакомых кейсов различных индустрий. Они и до сих пор считают это хорошим педагогическим подходом. Но с тех пор эти техники стали настолько стандартизированы, что многие архитекторы начинают с техник, а затем уже переходят к примерам использования.

Техники Кимбалла были широко распространены в индустрии. В качестве доказательства, некоторые бывшие студенты университета Кимбалла выпустили свои собственные книги. Но эти книги не расширили библиотеку техник в значительной мере и не создали конфликтующих разборов (только объясняли техники Кимбалла более точно и подробно).

Эта глава - "официальный" набор техник от создателей этих паттернов моделирования.

### Fundamental Concepts  
***(Основные понятия)*** стр 37

Техники этого раздела должны рассматриваться в течение разработки каждого дизайна размерного моделирования.

**Сбор бизнес-требований и реалий данных**

Перед моделированием команде нужно понять:
- как нужды бизнеса,
- так и реалии исходных данных.

Вы поймёте требования при помощи сессий с бизнес-заказчиками, направленных на раскрытие их целей KPI (key performance indicators - ключевые показатели эффективности), ключевых деловых запросов, процессов по принятию решений и поддержке аналитических нужд.

В то же время реалии исходных данных вы поймёте при помощи встреч с экспертами исходных систем и при помощи высокоуровневого профилирования данных для оценки их пригодности к использованию.

**Семинары по совместному размерному моделированию**

Модели размерного моделирования данных должны разрабатываться совместно с ключевыми экспертами в областях и представителями бизнеса по управлению данными. Модельер данных отвечает за разработку, однако модели должны быть раскрыты при помощи интерактивных семинаров с представителями бизнеса. Эти семинары даюь дополнительную возможность дополнить бизнес-требования.

Размерные модели не должны разработаться изолированно людьми, которые не полностью понимают бизнес и его нужды, взаимодействие с бизнесом критически важно.

**Четырех-ступенчатый процесс**

4 ключевые решения, совершаемых в течение моделирования, включают:
1. выбор бизнес-процесса
2. определение гранулярности
3. идентификация измерений
4. идентификация фактов

Благодаря этим шагам, команда дизайна моделирования определяет таблицу и названия столбцов, набор значений домена, бизнес-правила. Представители управления данными должны участвовать в этой детализирующей активности, чтобы обеспечить поддержку со стороны бизнеса.

**Бизнес-процессы**

Бизнес-процессы это опреационные активности, совершаемые вашей организацией (взятие заказа, регистрация студентов и т.п.). События бизнес-процессов генерируют метрики производительности, которые транслируются в факты в таблице фактов. Большинство таблиц фактов фокусируются на каком-то одном бизнес-процессе. Выбор процесса важен, потому что это определяет специфическую цель дизайна, позволяет гранулярности, измерениям и фактам быть декларированными. Каждый бизнес-процесс соответствует строке в матрице хранилища данных.

**Гранулярность**

Определение гранулярности - ключевой шаг в размерном моделировании. Гранулярность устанавливает, что представлет собой одна строка в таблице. Это становится договорённостью, связывающей весь дизайн. Гранулярность должна быть определена до выбора измерений или фактов. Эта последовательность усиливает унификацию всего размерного дизайна (что важно для использовавния в BI и для простоты использования).

Атомная гранулярность (atomic grain) относится к нижайшему уровню, на котором данные захвачены бизнес-процессом. Авторы строго рекомендуют начинать фокусироваться на атомной гранулярности, поскольку этот подход впоследствии устоит при возникновении непредсказуемых бизнес-запросов. Каждая предложенная гранулярность таблицы фактов реализуется в отдельной физической таблице. Различная гранулярность не должна смешиваться в одной таблице фактов.

**Измерения (dimensions) для описательного контекста**

Измерения задают "кто, что, где, когда, почему и как" контекст вокруг событий бизнес-процесса. Таблицы измерений содержат описательные атрибуты, используемые BI приложениями для фильтрации и группировки фактов. Имея в виду гранулряность таблицы фактов, можно идентифицировать все возможные измерения. Измерение, всегда, когда это возможно, должно иметь единственное значение при соединении со строкой из таблицы фактов.

Иногда таблицы измерений называют "душой" хранилища данных, потому что они они содержат входные точки и описательные лейблы, способствующие построению DW/BI бизнес-анализу. Диспропорциональное количество усилий прикладывается к управлению и разработке таблиц измерений, потому что они драйверы пользовательского BI опыта.

**Факты для измерений (measurements)**

Факты это такие измерения, которые происходят от событий бизнес-процесса и почти всегда измеряются числами. Отдельно взятая строка таблицы фактов имеет связь 1-к-1 к измеримому событию в соответствии с тем, как оно описано гранулярностью таблицы фактов. Таким образом таблица фактов соответствует физически наблюдаемому событию, а не требованиям конкретного отчёта. Внутри таблицы фактов могут быть только факты, соответствующие заявленной гранулярности.

**Схема звезда и OLAP кубы**

Схема звезда - это структура, развернутая в реляционной системе управления базами данных (`relational database management system (RDBMS)`). Такие структуры, что характерно, состоят из таблиц фактов, связанных с ассоциированными таблицами измерений при помощи связей первичных/внешних ключей (`PK, FK`). Куб онлайн-аналитической обработки (`online analytical processing (OLAP)`) - структура измерений, встроенная в размерную базу данных. Это может быть эквивалентно (а чаще происходит из) реляционной схеме звезда. OLAP куб содержит атрибуты измерений и факты, но может быть запрошен при помощи языков, имеющих более аналитические возможности, чем SQL (XMLA, MDX). OLAP кубы включены в список базовых техник, т.к. они часто являтся финальным шагом в развертывании dimensional DW/BI системы, или могут существовать как агрегирующая структура, основанная на более детальной (atomic) реляционной схеме звезда.

**Изящные расширения к размерным моделям**

Размерные модели устойчивы к  изменениям отношений данных. Все перечисленные ниже изменения могут быть встроены без изменения существующих BI запросов или приложений, и без каких-либо изменений в результататх этих запросов.

- факты, соответствующие гранулряности существующей таблицы фактов, могут быть добавлены при помощи добавления новых столбцов
- измерения могут быть добавлены к существующей таблице фактов при помощи создания столбца с новым внешним ключом (предполагая, что они не изменяют гранулярность таблицы фактов)
- атрибуты могут быть добавлены к существующей таблице измерений при помощи создания новых столбцов
- грануляция таблицы фактов может быть сделана более детальной (atomic) пр ипомощи добавления атрибутов к существующей таблице измерений, и затем при помощи переформулирования таблицы фактов в более детальной грануляции (аккуратно сохраняя существующие наименования столбцов в таблицах фактов и измерений).

### Basic Fact Table Techniques
***(Основные методы составления таблиц фактов)*** стр 41

**Структура таблицы фактов**

`Fact Table Structure`. Таблица фактов содержит числовые меры, произведенные операционно измеримым событием их реального мира. В самой детальной гранулярности, строка таблицы фактов соответствует измеримому событию и наоборот. Таким образом фундаментальный дизайн таблицы фактов целиком основан на физической активности, и не навеян отчётами, которые могут быть произведены. Вдобавок к числовым мерам, таблица фактов всегда содержит внешние ключи к каждому ассоциированному измерению, необязательные вырожденные ключи измерений и отметки даты/времени. Таблицы фактов - первая цель вычислений и динамических агрегаций, происходящих из запросов.

**Аддитивные, полуаддитивные и неаддитивные факты**

`Additive, Semi-Additive, Non-Additive Facts`
Числовые меры в таблице фактов бывают трех категорий. 

1) наиболее гибкие и полезные факты - полностью аддитивные (`fully additive`). Аддитивные меры могут быть просуммированы сквозь любые измерения, связанные с таблицей фактов.
2) полу-аддитивные (`semi-additive`) меры могут быть просуммированы сквозь некоторые измерения, но не все. Остатки на счёте - общая полу-аддитивная мера.
3) неаддитивные (`non-additive`) меры не могут быть просуммированы вообще. Например, доли. Наиболее хороший подход к таким мерам это, где возможно, хранить полностью аддитивные компоненты.

**Null в таблицах фактов**

`Nulls in Fact Tables`. Меры с пропусками данных (`null`) отлично вписываются в таблицы фактов. Агрегатные функции (`sum, count, min, max, avg`) - правильно обрабатывают такие данные. Но null нужно избегать во внешних ключах, т.к. они автоматически вызовут нарушение ссылочной целостности (`referential integrity violation`). Вместо null во внешнем ключе должна быть дефолтная строка для неопознанных данных.

**Согласованные факты**

`Conformed Facts`. Если одна и та же мера появляется в отдельных таблицах фактов, надо убедиться, что технические определения фактов идентичны. Если раздельные определения фактов соответствуют друг другу, они должны называться одинаково. Если же они несообразны, их следует специально назвать различным образом, предупреждая этим пользователей.

**Транзакционные таблицы фактов**

`Transaction Fact Tables`. Строка в транзакционной таблице фактов соответствует измеримому событию в точке времени и пространства. Таблицы фактов с гранулярностью транзакции - наиболее размерные и выразительные таблицы фактов. Эта устойчивая размерность даёт наиболее широкие возможности к нарезке и измельчению/препарированию (`slicing and dicing`) данных. Транзакционные таблицы фактов могут быть часто или редко заполненными, поскольку строки появляются, только если событие имело место.

**Периодические сводные таблицы фактов / Таблицы фактов периодических снимков** 

`Periodic Snapshot Fact Tables` - строка в такой таблице подводит итоги многим событиям, случившимся в заданный стандартный период (день, неделя, месяц). Гранулярность - период, не индивидуальные транзакции. Такие таблицы часто содержат  много фактов, поскольку любое измеримое событие, согласующееся с гранулярностью таблицы фактов, допустимо. Такие таблицы фактов плотно заполнены в их внешних ключах, потому что, даже если в заданный период не было активности, строка в такую таблицу всё равно вставляется (0 или null для каждого факта).

**Накопительные таблицы фактов**

`Accumulating Snapshot Fact Tables` - строка в такой таблице подводит итоги событиям, случившимся в прдесказанные шаги между началом и концом процесса. Конвейерные процессы, такие как заполнение заказа, которые имеют определенную стартовую точку, стандартные промежуточные шаги, и определенную конечную точку, могут быть моделированы при помощи такой таблицы. Для такой таблицы характерно постоянное обновление.

**Таблицы фактов без фактов**

`Factless Fact Tables`. Хотя большинство измеримых событий имеют числовой результат, возможно и такое, что событие просто записывает набор размерных сущностей, имеющихся в определенный момент. Для примера, факт посещения студентом занятия в заданный день может не иметь записанного числового факта, но строку с внешними ключами календарного дня, студента, преподавателя, локации, класса. Также таблицы фактов без фактов могут быть использованы для анализа того, что не случилось. Такие запросы всегда имеют две части: таблица без фактов, что содержит все возможные события и таблица активностей, что содержит события, которые случились.

**Агрегированные таблицы фактов или OLAP кубы**

`Aggregate Fact Tables or OLAP Cubes` - это просто числовые свёртывания данных из таблицы фактов, построенные для ускорения производительности запроса. Эти агрегированные данные должны быть доступны BI наряду с детализированными данными таблицы фактов, чтобы во время запроса можно было выбрать нужный уровень детализации данных. Этот процесс, называемый агрегатной навигацией (`aggregate navigation`), должен быть открытым, чтобы каждый автор отчёта, инструмент запросов, BI приложение пожинали одинаковые плоды выгодной производительности. Должным образом созданные наборы агрегатов должны проявлять себя подобно индексам баз данных, которые ускоряют производительность запроса, но напрямую не задаются ни BI приложением, ни бизнес-пользователем. Агрегированные таблицы фактов содержат внешние ключи к уменьшенным соответствующим размерностям (dimensions), так же как агрегированные факты, созданные при помощи суммирования мер из более детальных таблиц фактов. И, наконец, агрегированные OLAP кубы с суммированными мерами часто построены тем же образом, как реляционные агрегаты, но OLAP кубы задуманы для прямого использования бизнес-пользователями.

**Сводные таблицы фактов**

`Consolidated Fact Tables`. Часто удобно комбинировать факты множества процессов вместе в одной сводной таблице фактов, где они могут быть выражены в одинаковой гранулярности. Например, совершенные продажи могут быть комбинированы с прогнозом продаж, для того чтобы задачу сравнения факта и прогноза сделать быстрой и простой, по сравнению со сборкой данных из различных таблиц фактов. Такие таблицы добавляют тяжести ETL процессу, но снимают тяжесть с BI приложений. Такие таблицы должны быть рассмотрены для кросс-процессных метрик, которые часто анализируются вместе.

### Basic Dimensional Table Techniques
***(Основные методы работы с размерными таблицами)*** стр 46

**Структура таблицы измерений**

`Dimension Table Structure`. Каждая таблица измерений имеет единственный столбец с первичным ключом. Этот первичный ключ встроен как внешний ключ в любую связанную таблицу фактов, где для строки таблицы фактов корректен описательный контекст из таблицы измерений. Таблицы измерений обычно широкие, плоские денормализованные таблицы с множеством низко кардинальных текстовых атрибутов. НАиболее влиятельные атрибуты - подробные описания. Атрибуты таблиц измерений - первая цель ограничений и спецификаций группировки запросов и BI приложений. Описательные лейблы в отчётах - типичные доменные значения атрибутов таблиц измерений.

**Суррогатные ключи измерений**

`Dimension Surrogate Keys`. Таблица измерений создаётся с одним столбцом, служащим уникальным первичным ключом. Этот первичный ключ не может быть натуральным ключом из операционных данных, поскольку будет множество строк для натурального ключа, когда произойдут изменения с течением времени. К тому же, натуральные ключи для измерения могут быть созданы более чем одной системой, и эти натуральные ключи могут не сопоставляться или плохо администрироваться. Системам DW/BI нужен контроль над всеми первичными ключами измерений. Следует создать анонимные числовые первичные ключи для всех измерений. Эти суррогатные ключи измерений - числа, идущие в последовательности, начинающиеся от 1. Измерения времени освобождены от правила суррогатных ключей. Это измерение (высоко предсказуемое и устойчивое) может использовать более значимый первичный ключ.

**Естественные, Долговечные, Сверхъестественные ключи**

`Natural, Durable, and Supernatural Keys`. Натуральные (=естественные) ключи, созданные операционной исходной системой - предмет бизнес-правил за периметром контроля DW/BI системы. Например, номер сотрудника (natural key) может быть изменен, если тот уходит в отставку, а затем повторно принимается на работу. Если хранилище данных хочет иметь единый ключ для этого сотрудника, новый долговечный ключ должен быть создан. Такой ключ иногда упоминается как долговечный супернатуральный. Лучшие долговечные ключи имеют формат, независимый от исходного бизнес-процесса, и потому должны быть простыми числами, назначены в ряд, начинающийся от 1. В то время как несколько суррогатных ключей, ассоциированых с работником за время изменения его профиля, могут измениться, долговечный ключ не изменится.

**Углубленное изучение**

`Drilling Down`. Углубленное изучение - наиболее основополагающий подход, которым занимаются бизнес-пользователи. Это значит добавление нового заголовка к существующему запросу, а заголовок этот - атрибут таблицы измерений, добавляемый в `group by`. Атрибут может происходить из любого измерения, прикрепленного к таблице фактов.

**Вырожденные измерения**

`Degenerate Dimensions`. Иногда измерение создано так, что оно не имеет содержания кроме первичного ключа. Например, когда счёт имеет множество строк-пунктов. Такая строка таблицы фактов наследует все описательные внешние ключи таблицы измерений счёта, и сам счёт остаётся без уникального содержания. Но номер счёта остаётся валидным (действительным) dimension ключом для таблицы фактов на уровне пунктов счёта. Вырожденное измерение размещается в таблице фактов вместе с явным подтверждением, что нет связанной таблицы измерений. Вырожденнные измерения наиболее часты с транзакционными и накопительными таблицами фактов (`Accumulating Snapshot Fact Tables`).

**Денормализованные сплющенные размерности**

`Denormalized Flattened Dimensions`. В основном, дизайнеры размерностей должны сопротивляться побуждениям нормализовывать, вызванными годами операционного дизайна баз данных и вместо этого денормализовывать иерархии, зафиксированные в глубину со связями многие-к одному, в отдельные атрибуты сплющенной размерной строки. Денормализация размерностей поддерживает две близкий цели простоты и скорости.

**Множественные иерархии в измерениях**

`Multiple Hierarchies in Dimensions`. Многие измерения содержат более чем одну естественную иерархию. Например, календарные измерения могут иметь день в иерархии фискального периода, так же как и день в иерархии месяца и года. Измерения локации тоже могут иметь множество иерархий. Во всех этих случаях, отдельные иерархии могут изящно сосуществовать в одной таблице измерений.

**Флаги и индикаторы как текстовые атрибуты**

`Flags and Indicators as Textual Attributes`. Аббревиатуры, true/false флаги, опреауионные индикаторы должны быть дополнены в таблицах измерений полными текстовыми словами. Операционные коды со встроенными значениями внутри кода должны быть разобраны на отдельные части с пояснениями к каждой из частей.

**Отсутствующие значения атрибутов в измерениях**

`Null Attributes in Dimensions`. Такие значения получаются, когда заданная строка измерения не была полностью заполнена, или были атрибуты, которые не применимы ко всем строкам измерения. В обоих случаях рекомендация - заполнять null заменяющей описательной строкой (Unknown, Not Applicable вместо null).

**Измерения календарной даты**

`Calendar Date Dimensions`. Каждая таблица фактов должна иметь возможность сопоставить всевозможные специфические данные по календарю - фискальные периоды, праздники (например, чтобы не писать SQL-запрос, выводящий Пасху в какой-то год). Всё это должно быть возможно посмотреть в готовой таблице измерений. Для такой таблицы можно подобрать более осознанный первичный ключ, например, число, представляющее YYYYMMDD вместо обычного суррогатного ключа из последовательности чисел.

**Роли измерений**

`Role-Playing Dimensions`. Одно и то же физическое измерение может быть использовано несколько раз, с разными ролями. Для примера, это возможно с датами.

**Мусорное измерение**

`Junk Dimensions`. Транзакционный процесс обычно производит некоторое количество разнообразных, низко-кардинальных флагов и и ндикаторов. Вместо того, чтобы делать отдельную таблицу под каждый флаг и атрибут, можно создать общее измерение для таки данных. Такое измереине часто называют `transaction profile dimension`.

**Снежинистые измерения**

`Snowflaked Dimensions`. Когда иерархические связи в таблице измерений нормализованы, низко-кардинальные атрибуты появляются во второстепенных таблицах, соединенных с базовой таблицей измерений ключом атрибута. Когда такой процесс повторен для всей иерархии измерений, появившаяся многоступенчатая структура зовётся снежинкой. И, хотя такая структура представляет иерархию более чётко, следует избегать снежинок, поскольку бизнес-пользователям трудно понимать и ориентироваться в снежинках. А также это негативно может сказываться на производительности. Плоская денормализованная таблица измерений содержит всю ту же самую информацию.

**Внешние измерения**

`Outrigger Dimensions`. Измерение может содержать ссылку на другую таблицу измерений. Для примера, измерение банковского счёта может ссылаться на отдельную таблицу, представляющую дату, когда был открыт счёт. Такие вторые измерения называются внешними. Такие измерения допустимы, но применять их следует не часто. В большинстве случаев корреляции между измерениями следует снизить до таблицы фактов, где оба измерения будут представлены в качестве отдельных внешних ключей.

### Integration via Conformed Dimensions
***(Интеграция посредством конформных размеров)*** стр 50

Одно из важных достижений подхода размерного моделирования - определение простого, но мощного рецепта интеграции данных различных бизнес-процессов.

**Согласованные измерения**

`Conformed Dimensions`. Таблицы измерений согласованы, когда атрибуты в отдельных таблицах измерений имеют одинаковые названия столбцов и доменное содержание. Информация из отдельных таблиц фактов может быть собрана в единый отчёт при помощи использования атрибутов согласованных измерений, которые ассоциированы с каждой таблицей фактов. Когда согласованный атрибут используется в качестве заголовка (т.е. столбца, по которому идет группировка), результаты отдельных таблиц фактов могут быть выровнены на одном уровне строк в drill-across отчёте. Это сущность интеграции в DW/BI системе. Согласованные измерения, заданные однажды в сотруднчестве в представителями управления данными бизнеса, переипользуются в таблицах фактов. Это подлерживает аналитическую последовательность и уменьшает издержки будущих разработок.

**Уменьшенные измерения**

`Shrunken Dimensions`. Это согласованные измерения, которые являются подмножеством строк и/или столбцов базового измерения. Уменьшенные свернутые измерения требуются при построении агрегированных таблиц фактов. Также они необходимы для для бизнес-процессов, которые захватывают данные на более обобщенном уровне гранулярности (например, прогноз на месяц).

**Бурение поперек**

`Drilling Across`. Это значит создание отдельных запросов для двух и более таблиц фактов, где заголовки строк каждого запроса состоят из идентичных согласованных измерений. Вендоры BI называют такую функциональность различными способами, включая "доносчик (`snitch`) и многопроходный запрос (`multipass query`).

**Цепочка создания стоимости**

`Value Chain`. Это значит натуральный поток первичных бизнес-процессов организации. Операционные системы обычно производят транзакции или снэпшоты на каждом шагу цепочки. Поскольку каждый процесс производит уникальные метрики в уникальные интервалы с уникальной гранулярностью и размерностью, каждый процесс производит как минимум одну таблицу фактов.

**Автобусная архитектура корпоративного хранилища данных**

`Enterprise Data Warehouse Bus Architecture`. Это предоставление инкрементальный подход к построению DW/BI системы. Эта архитектура декомпозирует DW/BI процессы планирования на управляемые части с фокусировкой на бизнес-процесс, достигая интеграции при помощи согласованных измерений, которые переиспользуются по ходу процесса. Это предоставляет архитектурный фреймворк.

**Автобусная матрица корпоративного хранилища данных**

`Enterprise Data Warehouse Bus Matrix`. Это незаменимый инструмент для создания и взаимодействия с архитектурой хранилища данных (`Enterprise Data Warehouse Bus Architecture`). Строки матрицы - бизнес-процессы, столбцы - измерения.

**Детальная реализация автобусной матрицы**

`Detailed Implementation Bus Matrix`. Это более гранулярная автобусная матрица, где каждая строка бизнес-процесса расширена, чтобы показать таблицы фактов или OLAP кубы.

**Матрица возможностей/заинтересованных сторон**

`Opportunity/Stakeholder Matrix`. После определения автобусной матрицы можно создать другую матрицу при помощи замещения столбцов измерений бизнес-функциями (маркетинг, продажи и тп) и затем закрасить клетки матрицы для определения, какие бизнес-функции заинтересованы в каких строках бизнес-процесса. Эта матрица помогает идентифицировать, какие бизнес-группы следут пригласить на совместные дизайн сессии для каждого ряда процессов.

### Dealing with Slowly Changing Dimension Attributes
***(Работа с атрибутами медленно изменяющихся измерений)***

Этот раздел описывает фундаментальные подходы к работе с атрибутами медленно изменяющихся измерений.

`Type 0: Retain Original`

С этим типом значение размерного атрибута никогда не меняется. Тип 0 подходит для любых атрибутов с лейблом "оригинальный" (`original`), например, изначальный уровень кредитной карты покупателя или "длящийся" (`durable`) идентификатор. Также это подходит для большинства атрибутов в измерении дат.

`Type 1: Overwrite`

С этим типом  старое значение атрибута в строке измерений перезаписывается новым значением. Атрибуты при типе 1 всегда отражают наиболее актуальное состояние, и потому этот подход уничтожает историю. И хотя этот подход легко внедрить и он не создаёт дополнительных строк измерений, вы должны быть начеку в том, что агрегированные таблицы фактов и OLAP кубы, затронутые изменением, пересчитываются.

`Type 2: Add New Row`

Тип 2 добавляет новую строку в измерение с обновленным значением атрибута. Это требует обобщения первичного ключа (`generalizing the primary key`) измерения за пределами натурального или длящегося (`durable`) ключа, поскольку потенциально возможно множество строк, описыващих каждого участника. Когда создана новая строка для участника измерения, новый первичный суррогатный ключ создаётся и используется как внешний ключ во всех таблицах фактов с момента обновления и до тех пор, пока последующее изменение создаст новый ключ измерения и обновит строку измерения. Минимум 3 дополнительных столбца должны быть добавлены к строке измерений с типом 2:
1) дата вступления в силу строки или отметка даты/времени (`row effective date or data/time stamp`)
2) дата истечения срока действия строки или отметка даты/времени (`row expiration date or date/time stamp`)
3) индикатор текущей строки (`current row indicator`)

`Type 3: Add New Attribute`

При типе 3 добавляется новый атрибут в измерение с целью сохранения значения старого атрибута, новое значение переписывает главный атрибут как в типе 1. Этот тип 3 иногда называют альтернативной реальностью. Бизнес-пользователь может группировать и фильтровать данные фактов как с текущим значением, так и с альтернативной реальностью. Эта техника работы с SCD используется относительно редко.

`Type 4: Add Mini-Dimension`

Техника типа 4 используется, когда группа атрибутов в измерении быстро изменяется и раделяется на мини-измерения. Эта ситуация иногда называется быстро меняющимся монструозным измерением (`rapidly changing monster dimension`). Часто используемые атрибуты в таблицах измерений с многомиллионным кол-вом строк - кандидаты на дизайн мини-измерений, даже если они меняются не часто. Тип 4 требует свой собственный уникальный первичный ключ, первичные ключи обоих - бизового измерения и мини-измерения - захватываются в ассоциированых таблицах фактов.

`Type 5: Add Mini-Dimension and Type 1 Outrigger`

Техника типа 5 используется для точного сохранения исторических значений атрибутов, плюс для исторической отчётности в соответствии с нужными значениями атрибутов. Тип 5 строится на типе 4  а также встраивании ссылки типа 1 мини-измерению в базовом измерении. Это позволяет текущему атрибуту мини-измерения быть доступным наряду с другими атрибутами базового измерения не через соединение с таблицей фактов. Логически, вы отображаете базовое измерение и мини-измерение как одну-единственную таблицу. ETL должен переписывать эту ссылку мини-измерения типа 1 всегда, когда изменяется текущее состояние мини-измерения.

`Type 6: Add Type 1 Attributes to Type 2 Dimension`

Подобно 5-му типу, тип 6 также доставляет и историческое, и текущее значения атрибутов таблицы измерений. Тип 6 строится на типе 2 а также встраивании текущей версии типа 1 одних и тех же атрибутов в строку измерений. В этом подходе, атрибут типа 1 систематически перезаписывается во всех строках, ассоциированных с отдельным длящимся ключом каждый раз когда атрибут обновляется.

`Type 7: Dual Type 1 and Type 2 Dimensions`

Это финальная гибридная техника, используемая для поддержания и "как было" и "как стало" отчётности. Таблица фактов может быть доступна при помощи измерения, смоделированного одновременно и как тип 1 - показывающего только наиболее актуальные значения атрибутов, и как тип 2 - показывающего верные во времени исторчиеские данные. Одна и та же таблица измерений представляет обе перспективы.

### Dealing with Dimension Hierarchies
***(Работа с иерархиями измерений)*** стр 56

Иерархии измерений - это общее место. Этот раздел описывает подходы к взаимодействию с иерархиями, начиная с наиболее базовых подходов.

**Иерархии фиксированной глубины**

`Fixed Depth Positional Hierarchies`. Это серия связей многие-к-одному, таких как продукт к бренду к категории к департаменту. Когда иерархия фиксированной глубины определена, и уровни иерархии определны по именам, уровни иерархии должны появиться в качестве отдельно позиционированных атрибутов в таблице измерений. Такая иерархия - наиболее простая для понимания и навигации так долго, пока  критерии наверху сопоставлены. Также этот подход способствует предсказуемой и быстрой скорости запросов. Когда иерархия это не серия взаимосвязей многие-к-одному, или число уровней варьируется так что уровни не имеют согласия по именам, - в таком случае следует рассмотреть технику ниже.

**Иерархические структуры с небольшой вариативностью глубины уровней**

`Slightly Ragged/Variable Depth Hierarchies`. стр 57







### Advanced Fact Table Techniques
***(Передовые методы составления таблиц фактов)*** стр 58

### Advanced Dimension Techniques
***(Передовые методы измерения)*** стр 62

### Special Purpose Schemas
***(Схемы специального назначения)*** стр 67
